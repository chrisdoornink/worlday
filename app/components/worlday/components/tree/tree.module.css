.tree {
  position: absolute;
  width: calc(8px * var(--scale-factor));
  transform-origin: bottom center;
  animation: treeSway 4s ease-in-out infinite;
  animation-delay: calc(var(--random-delay) * -1s);
  pointer-events: none;
}

.trunk {
  position: absolute;
  bottom: 0;
  left: 50%;
  transform: translateX(-50%);
  width: 100%;
  height: 100%;
  background: #1a1a1a;
  box-shadow: 
    inset -1px 0 2px rgba(255, 255, 255, 0.1),
    inset 1px 0 2px rgba(0, 0, 0, 0.3);
  border-radius: 0;
  transform-origin: bottom center;
  backdrop-filter: blur(0.5px);
  opacity: 0.9;
}

.trunk::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: 
    repeating-linear-gradient(
      45deg,
      transparent,
      transparent 2px,
      rgba(0, 255, 255, 0.03) 2px,
      rgba(0, 255, 255, 0.03) 4px
    ),
    repeating-linear-gradient(
      -45deg,
      transparent,
      transparent 2px,
      rgba(255, 0, 255, 0.03) 2px,
      rgba(255, 0, 255, 0.03) 4px
    );
  filter: blur(0.5px);
  animation: textureShift 8s linear infinite;
}

.branch {
  position: absolute;
  bottom: var(--branch-height);
  left: 50%;
  width: calc(8px * var(--scale-factor) * var(--branch-thickness) / 100);
  height: calc(var(--branch-length) * 1%);
  background: #1a1a1a;
  transform-origin: bottom center;
  transform: translateX(-50%) rotate(var(--branch-angle));
  border-radius: 0;
  animation: branchSway 3s ease-in-out infinite;
  animation-delay: calc((var(--random-delay) + var(--branch-height) * 0.0002) * -1s);
  box-shadow: 
    inset -1px 0 2px rgba(255, 255, 255, 0.1),
    inset 1px 0 2px rgba(0, 0, 0, 0.3);
  backdrop-filter: blur(0.5px);
  opacity: 0.9;
}

.branch::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: 
    repeating-linear-gradient(
      45deg,
      transparent,
      transparent 2px,
      rgba(0, 255, 255, 0.03) 2px,
      rgba(0, 255, 255, 0.03) 4px
    ),
    repeating-linear-gradient(
      -45deg,
      transparent,
      transparent 2px,
      rgba(255, 0, 255, 0.03) 2px,
      rgba(255, 0, 255, 0.03) 4px
    );
  filter: blur(0.5px);
  animation: textureShift 8s linear infinite;
}

.foliage {
  position: absolute;
  top: -20%;
  left: 50%;
  width: calc(15px * var(--scale-factor));
  height: calc(15px * var(--scale-factor));
  transform: translateX(-50%);
  background: radial-gradient(
    circle at center,
    rgba(0, 255, 200, 0.2) 0%,
    rgba(0, 255, 200, 0.15) 30%,
    rgba(0, 255, 200, 0.08) 60%,
    transparent 80%
  );
  filter: blur(3px);
  mix-blend-mode: screen;
  animation: foliagePulse 4s ease-in-out infinite;
}

.foliage1 {
  animation-delay: calc(var(--random-delay) * -1s);
}

.foliage2 {
  top: -30%;
  left: 40%;
  transform: translateX(-50%) rotate(-15deg);
  animation-delay: calc((var(--random-delay) + 1) * -1s);
}

.foliage3 {
  top: -25%;
  left: 60%;
  transform: translateX(-50%) rotate(15deg);
  animation-delay: calc((var(--random-delay) + 2) * -1s);
}

.trunkFoliage {
  width: calc(20px * var(--scale-factor));
  height: calc(20px * var(--scale-factor));
}

.trunkFoliage.foliage1 {
  top: -10%;
}

.trunkFoliage.foliage2 {
  top: -15%;
  left: 35%;
}

.trunkFoliage.foliage3 {
  top: -12%;
  left: 65%;
}

.foliageGlow {
  position: absolute;
  top: -35%;
  left: 50%;
  width: calc(25px * var(--scale-factor));
  height: calc(25px * var(--scale-factor));
  transform: translateX(-50%);
  background: radial-gradient(
    circle at center,
    rgba(150, 255, 220, 0.15) 0%,
    rgba(100, 255, 200, 0.08) 40%,
    rgba(50, 255, 180, 0.04) 70%,
    transparent 90%
  );
  filter: blur(6px);
  mix-blend-mode: screen;
  animation: foliageGlowPulse 6s ease-in-out infinite;
  animation-delay: calc((var(--random-delay) + 2) * -1s);
}

.foliageGlow2 {
  top: -40%;
  width: calc(35px * var(--scale-factor));
  height: calc(35px * var(--scale-factor));
  filter: blur(8px);
  opacity: 0.7;
  animation-delay: calc((var(--random-delay) + 4) * -1s);
}

.trunkFoliage.foliageGlow {
  top: -20%;
  width: calc(30px * var(--scale-factor));
  height: calc(30px * var(--scale-factor));
  filter: blur(8px);
}

.trunkFoliage.foliageGlow2 {
  top: -25%;
  width: calc(40px * var(--scale-factor));
  height: calc(40px * var(--scale-factor));
  filter: blur(10px);
}

@keyframes foliagePulse {
  0%, 100% {
    opacity: 0.9;
    transform: translateX(-50%) scale(1);
  }
  50% {
    opacity: 1;
    transform: translateX(-50%) scale(1.2);
  }
}

@keyframes foliageGlowPulse {
  0%, 100% {
    opacity: 0.7;
    transform: translateX(-50%) scale(1.1);
  }
  50% {
    opacity: 0.9;
    transform: translateX(-50%) scale(0.9);
  }
}

@keyframes textureShift {
  0% {
    background-position: 0 0;
  }
  100% {
    background-position: 50px 50px;
  }
}

/* Tree swaying animation */
@keyframes treeSway {
  0%, 100% {
    transform: rotate(calc(var(--wind-direction) * -1deg * var(--wind-intensity)));
  }
  50% {
    transform: rotate(calc(var(--wind-direction) * 2deg * var(--wind-intensity)));
  }
}

/* Branch swaying animation */
@keyframes branchSway {
  0%, 100% {
    transform: translateX(-50%) 
      rotate(calc(var(--branch-angle) + var(--wind-direction) * -2deg * var(--wind-intensity)));
  }
  50% {
    transform: translateX(-50%)
      rotate(calc(var(--branch-angle) + var(--wind-direction) * 2deg * var(--wind-intensity)));
  }
}
